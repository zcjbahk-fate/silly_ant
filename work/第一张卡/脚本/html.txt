```html
<!doctype html>
<html lang="zh-CN">
<head>
  <style>
    @import url(https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap);

    /* === é…è‰²æ–¹æ¡ˆ (è‰²æ°”å¢å¼ºç‰ˆ) === */
    :root {
      --bg-color: transparent;
      --card-bg-color: rgba(255, 248, 250, 0.96);
      --border-color: rgba(255, 182, 193, 0.6);

      --text-primary: #590d22;
      --text-secondary: #a4133c;
      --accent: #ff0a54;

      /* æ¬²æœ›è‰²è°± */
      --c-love-light: #ffccd5;
      --c-love-deep: #ff4d6d;
      --c-depravity-light: #e0c3fc;
      --c-depravity-deep: #7b2cbf;
      --c-lust-light: #ffb3c1;
      --c-lust-deep: #c9184a;
      --c-ntr-light: #d8f3dc;
      --c-ntr-deep: #2d6a4f;

      --glass-bg: rgba(255, 255, 255, 0.65);
    }

    body { margin: 0; padding: 0; font-family: "Noto Sans SC", sans-serif; font-size: 14px; color: var(--text-primary); }

    /* åŠ¨ç”» */
    @keyframes breathe { 0% { opacity: 0.85; } 50% { opacity: 1; } 100% { opacity: 0.85; } }

    .status-card {
      width: 100%; height: 100%;
      background: var(--card-bg-color);
      border-radius: 12px; overflow: hidden;
      border: 1px solid var(--border-color);
      display: flex; flex-direction: column;
    }

    /* === Tab === */
    /* ç§»é™¤é¡¶éƒ¨ç¯å¢ƒæ¡åï¼ŒTab ç›´æ¥é¡¶å¤´æ˜¾ç¤ºï¼ŒåŠ ä¸€ç‚¹ä¸Šè¾¹è·ç¾è§‚ */
    .tabs {
      display: flex; background: rgba(255,255,255,0.5);
      border-bottom: 1px solid rgba(0,0,0,0.05);
      padding-top: 5px;
    }
    .tab-button {
      flex: 1; padding: 10px; border: none; background: transparent;
      color: var(--text-secondary); cursor: pointer; font-weight: 500;
      border-bottom: 2px solid transparent; transition: all 0.2s;
    }
    .tab-button.active { color: var(--accent); background: rgba(255,10,84,0.03); border-bottom-color: var(--accent); font-weight: bold; }

    .tab-container { flex: 1; overflow-y: auto; padding: 15px; }
    .tab-page { display: none; }
    .tab-page.active { display: block; animation: fadeIn 0.3s; }
    @keyframes fadeIn { from{opacity:0;transform:translateY(5px)} to{opacity:1;transform:translateY(0)} }

    /* === é€šç”¨ç»„ä»¶ === */
    .section-header {
      font-size: 0.95em; color: var(--text-secondary); font-weight: bold;
      margin: 15px 0 8px 0; padding-left: 8px; border-left: 3px solid var(--accent);
      display: flex; justify-content: space-between; align-items: center;
    }
    .section-header:first-child { margin-top: 0; }

    .card-box {
      background: var(--glass-bg);
      border: 1px solid rgba(255,192,203,0.5);
      border-radius: 8px; padding: 10px; margin-bottom: 8px;
      box-shadow: 0 2px 6px rgba(255,182,193,0.15);
    }

    .kv-row { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 5px; }
    .kv-row:last-child { margin-bottom: 0; }
    .k-label { color: var(--text-secondary); font-size: 0.9em; flex-shrink: 0; margin-right: 10px; }
    .v-val { color: var(--text-primary); font-weight: 500; text-align: right; word-break: break-all; }

    /* === æ»‘æ¡ === */
    .slider-box { margin-bottom: 10px; }
    .slider-info { display: flex; justify-content: space-between; font-size: 0.9em; color: var(--text-secondary); margin-bottom: 3px; }
    .slider-track { height: 8px; background: rgba(0,0,0,0.06); border-radius: 4px; overflow: hidden; }
    .slider-fill {
      height: 100%; border-radius: 4px;
      animation: breathe 3s infinite ease-in-out;
      background-size: 200% auto;
      transition: width 0.5s;
    }

    /* === è‚‰æ£’çŠ¶æ€ === */
    .penis-card {
      background: linear-gradient(to bottom right, #fff0f3, #fff);
      border: 1px solid var(--c-lust-deep);
      border-radius: 10px; padding: 12px;
      text-align: center; margin-bottom: 15px;
      box-shadow: 0 4px 10px rgba(255,77,109,0.15);
    }
    .penis-bar-bg {
      height: 12px; background: #ffe5ec; border-radius: 6px; margin: 8px 0;
      position: relative; box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);
    }
    .penis-bar-fill {
      height: 100%; border-radius: 6px;
      background: linear-gradient(90deg, #ff8fa3, #800f2f);
      box-shadow: 0 0 8px rgba(255,0,80,0.3);
      transition: width 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    }
    .penis-dot {
      width: 14px; height: 14px; background: #fff; border: 2px solid #d90429;
      border-radius: 50%; position: absolute; top: 50%; transform: translate(-50%,-50%);
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }

    /* === æˆ˜ç»©å›¾æ ‡ === */
    .sex-grid {
      display: grid; grid-template-columns: repeat(3, 1fr); gap: 4px;
      background: rgba(255,255,255,0.5); padding: 8px; border-radius: 8px;
    }
    .sex-item { text-align: center; }
    .sex-icon { font-size: 1.3em; display: block; filter: drop-shadow(0 2px 2px rgba(0,0,0,0.1)); }
    .sex-num { font-size: 0.8em; font-weight: bold; color: var(--c-lust-deep); }

    /* === åˆ—è¡¨å¹´é¾„ç¾åŒ– === */
    .age-badge {
      font-size: 0.75em; background: rgba(0,0,0,0.05); color: #888;
      padding: 1px 5px; border-radius: 4px; margin-left: 5px; font-weight: normal;
      vertical-align: middle;
    }

    /* === è¾…åŠ© === */
    .back-btn { color: var(--accent); cursor: pointer; font-weight: bold; margin-bottom: 10px; display: inline-flex; align-items: center; }
    .hidden { display: none !important; }
  </style>

  <script type="module">
    let globalVars = {};

    // å›¾æ ‡æ˜ å°„
    const ICONS = { æ€»æ•°: 'âˆ‘', å£äº¤: 'ğŸ‘„', è¶³äº¤: 'ğŸ¦¶', æ’å…¥: 'ğŸ’“', è‚›äº¤: 'ğŸ©', æ‰‹äº¤: 'ğŸ‘‹' };

    function renderSlider(label, val, c1, c2) {
      const v = parseInt(val) || 0;
      const pct = Math.min(100, Math.max(0, v));
      return `
        <div class="slider-box">
          <div class="slider-info"><span>${label}</span><span style="color:${c2};font-weight:bold">${v}</span></div>
          <div class="slider-track">
            <div class="slider-fill" style="width:${pct}%; background: linear-gradient(90deg, ${c1}, ${c2}); box-shadow: 0 0 5px ${c1};"></div>
          </div>
        </div>`;
    }

    function renderSexStats(expObj) {
      if (!expObj) return '<div style="font-size:0.8em;color:#999;text-align:center">æš‚æ— è®°å½•</div>';
      let data = expObj;
      if (data.æ€»æ•° === undefined) {
        data = { ...expObj };
        data.æ€»æ•° = ['å£äº¤','è¶³äº¤','æ’å…¥','è‚›äº¤','æ‰‹äº¤'].reduce((sum, k) => sum + (parseInt(data[k]) || 0), 0);
      }
      let h = '<div class="sex-grid">';
      ['æ€»æ•°', 'å£äº¤','è¶³äº¤','æ’å…¥','è‚›äº¤','æ‰‹äº¤'].forEach(k => {
        h += `<div class="sex-item"><span class="sex-icon">${ICONS[k]}</span><span class="sex-num">${data[k]||0}</span></div>`;
      });
      h += '</div>';
      return h;
    }


    // 1. æ¸²æŸ“ä¸»é¡µé¢ï¼ˆä»…æ¸²æŸ“Schemaä¸­å­˜åœ¨çš„ï¼šè‚‰æ£’çŠ¶æ€ã€æ€§ç»å†ç»Ÿè®¡ï¼‰
    function renderMain() {
      const mc = _.get(globalVars, 'stat_data.ä¸»è§’', {});

      // è‚‰æ£’çŠ¶æ€
      const p = mc.æ€§å™¨çŠ¶æ€?.è‚‰æ£’ || {};
      const cur = parseFloat(p.å½“å‰é•¿åº¦)||0;
      const min = parseFloat(p.é•¿åº¦èŒƒå›´?.æœ€å°)||5;
      const max = parseFloat(p.é•¿åº¦èŒƒå›´?.æœ€å¤§)||18;
      const pct = Math.min(100, Math.max(0, (cur-min)/(max-min)*100));

      $('#mc-penis').html(`
        <div style="display:flex;justify-content:space-between;font-weight:bold;color:var(--c-lust-deep);margin-bottom:5px">
          <span>${p.çŠ¶æ€ || 'å¸¸æ€'}</span>
          <span>${cur} cm</span>
        </div>
        <div class="penis-bar-bg"><div class="penis-bar-fill" style="width:${pct}%"></div><div class="penis-dot" style="left:${pct}%"></div></div>
        <div style="font-size:0.85em;color:#888;font-style:italic">"${p.æè¿°||'...'}"</div>
      `);

      // æˆ˜ç»©ç»Ÿè®¡
      let sexH = '';
      Object.entries(mc.æ€§ç»å†||{}).forEach(([n, d]) => {
         sexH += `<div style="margin:5px 0 2px 5px;font-size:0.85em;font-weight:bold;color:var(--accent)">â™¥ ${n}</div>` + renderSexStats(d);
      });
      $('#mc-sex-exp').html(sexH || '<div style="color:#999;text-align:center">å¤„ç”·</div>');
    }

    // 2. æ¸²æŸ“è§’è‰²åˆ—è¡¨
    function renderList() {
      const chars = _.get(globalVars, 'stat_data.è§’è‰²', {});
      const box = $('#char-list-box');
      if(!chars || Object.keys(chars).length === 0) {
        box.html('<div style="padding:20px;text-align:center;color:#999">æš‚æ— è§’è‰²</div>');
        return;
      }

      let html = '';
      Object.entries(chars).forEach(([name, data]) => {
        const ageHtml = data.å¹´é¾„ ? `<span class="age-badge">${data.å¹´é¾„}å²</span>` : '';
        html += `
          <div class="card-box" style="cursor:pointer;display:flex;justify-content:space-between;align-items:center;transition:all 0.2s"
               onclick="window.showChar('${name}')" onmouseover="this.style.borderColor='var(--accent)'" onmouseout="this.style.borderColor='rgba(255,192,203,0.5)'">
            <div>
              <div style="font-weight:bold;font-size:1.05em">${name} ${ageHtml}</div>
              <div style="font-size:0.8em;color:var(--text-secondary);margin-top:2px">${data.å½“å‰å§¿åŠ¿||'æ— è®°å½•'}</div>
            </div>
            <div style="text-align:right;font-size:0.9em">
              <div style="color:var(--c-love-deep)">â™¥ ${data.å¥½æ„Ÿåº¦||0}</div>
              <div style="color:var(--c-lust-deep)">â™¨ ${data.æ€§æ¬²å€¼||0}</div>
            </div>
          </div>
        `;
      });
      box.html(html);
    }

    // 3. æ¸²æŸ“è¯¦æƒ…
    window.showChar = function(name) {
      const data = _.get(globalVars, `stat_data.è§’è‰².${name}`, {});
      $('#view-list').addClass('hidden');
      $('#view-detail').removeClass('hidden');
      $('#detail-name').text(name);
      $('#detail-age').text(data.å¹´é¾„ ? `${data.å¹´é¾„}å²` : '');
      $('#detail-pose').text(data.å½“å‰å§¿åŠ¿ || 'æ— è®°å½•');

      // åŸºç¡€ä¸‰ç»´
      let s = '';
      s += renderSlider('â™¥ å¥½æ„Ÿåº¦', data.å¥½æ„Ÿåº¦, '#ffdde1', '#ee9ca7');
      s += renderSlider('â˜  å •è½åº¦', data.å •è½åº¦, '#e0c3fc', '#8e44ad');
      s += renderSlider('â™¨ æ€§æ¬²å€¼', data.æ€§æ¬²å€¼, '#ffcfdf', '#ff0a54');
      $('#detail-stats').html(s);

      // NTR å…³ç³»
      const ntr = data.NTRå…³ç³» || {};
      const kuzhu = ntr.è‹¦ä¸»å§“å || 'æœªçŸ¥';
      const records = ntr.å‡ºè½¨è®°å½• || {};

      let ntrHtml = `<div class="kv-row"><span class="k-label">è‹¦ä¸»</span><span class="v-val" style="color:var(--text-primary)">${kuzhu}</span></div>`;
      if (Object.keys(records).length === 0) {
        ntrHtml += '<div style="color:#999;font-size:0.85em;text-align:center;margin-top:5px">æš‚æ— å‡ºè½¨è®°å½•</div>';
      } else {
        ntrHtml += '<div style="border-top:1px dashed #eee;margin:5px 0"></div>';
        Object.entries(records).forEach(([hmName, hmData]) => {
           const val = hmData.NTR || 0;
           ntrHtml += `<div style="font-size:0.85em;color:var(--c-ntr-deep);font-weight:bold;margin-top:2px">vs ${hmName}</div>`;
           ntrHtml += renderSlider('NTRå€¼', val, '#d4fc79', '#96e6a1');
        });
      }
      $('#detail-ntr').html(ntrHtml);

      // å¿ƒç†æ´»åŠ¨
      $('#detail-mind').html(`
        <div style="margin-bottom:6px">
           <div style="font-size:0.8em;color:#aaa">å†…å¿ƒæƒ³æ³•</div>
           <div class="card-box" style="font-size:0.9em;color:#555;font-style:italic">"${data.å†…å¿ƒæƒ³æ³•||'...'}"</div>
        </div>
        <div>
           <div style="font-size:0.8em;color:#aaa">å¯¹ä¸»è§’å°è±¡</div>
           <div class="card-box" style="font-size:0.9em;color:#555;font-style:italic">"${data.å¯¹ä¸»è§’çœ‹æ³•||'...'}"</div>
        </div>
      `);

      // æ€§çˆ±è®°å½•ï¼ˆä½“å†…ç²¾æ¶²ã€ä¸Šæ¬¡åšçˆ±ï¼‰
      const semen = data.ä½“å†…ç²¾æ¶² || {};
      $('#detail-body').html(Object.entries(semen).map(([k,v]) => `
        <div class="kv-row"><span class="k-label">${k}</span><span class="v-val" style="font-size:0.85em">${v.é‡}ml (${v.çŠ¶æ€})</span></div>
      `).join('') || '<div style="color:#999;font-size:0.9em">å­å®«ç©ºç©º</div>');

      const last = data.ä¸Šæ¬¡åšçˆ± || {};
      $('#detail-last').html(last.æ—¶é—´ ? `
        <div class="kv-row"><span class="k-label">æ—¶é—´</span><span class="v-val">${last.æ—¶é—´}</span></div>
        <div class="kv-row"><span class="k-label">å¯¹è±¡</span><span class="v-val">${last.å¯¹è±¡}</span></div>
        <div style="font-size:0.85em;color:#666;text-align:right;margin-top:2px">${last.åœ°ç‚¹} Â· ${last.æ–¹å¼}</div>
      ` : '<div style="color:#999;font-size:0.9em">æš‚æ— è®°å½•</div>');

      // æ€§ç»å†ç»Ÿè®¡
      let expH = '';
      Object.entries(data.æ€§ç»å†||{}).forEach(([n,d]) => {
        expH += `<div style="margin:5px 0 2px 0;font-size:0.85em">vs ${n}</div>` + renderSexStats(d);
      });
      $('#detail-sex').html(expH || 'æ— ');
    }

    window.backToList = function() { $('#view-detail').addClass('hidden'); $('#view-list').removeClass('hidden'); };

    async function init() {
      await waitGlobalInitialized('Mvu');

      const refresh = () => {
        globalVars = getAllVariables();
        renderMain();
        if($('#view-list').is(':visible') && $('#page-chars').is(':visible')) {
          renderList();
        } else if ($('#view-detail').is(':visible') && $('#page-chars').is(':visible')) {
           const n = $('#detail-name').text();
           if(n) window.showChar(n);
        }
      };

      refresh();
      eventOn(Mvu.events.VARIABLE_UPDATE_ENDED, refresh);

      $('.tab-button').click(function(){
        $('.tab-button').removeClass('active'); $(this).addClass('active');
        $('.tab-page').removeClass('active');
        const target = $($(this).data('target'));
        target.addClass('active');
        if($(this).data('target') === '#page-chars') {
           if($('#view-list').is(':visible')) renderList();
        }
      });
    }
    $(errorCatched(init));
  </script>
</head>
<body>
  <div class="status-card">
    <div class="tabs">
      <button class="tab-button active" data-target="#page-main">è‡ªæˆ‘</button>
      <button class="tab-button" data-target="#page-chars">ä¼—ç¾</button>
    </div>

    <div class="tab-container">

      <div id="page-main" class="tab-page active">
        <div class="penis-card" id="mc-penis"></div>
        <div class="section-header">æˆ˜ç»©ç»Ÿè®¡</div>
        <div id="mc-sex-exp"></div>
      </div>

      <div id="page-chars" class="tab-page">
        <div id="view-list">
          <div id="char-list-box"></div>
        </div>

        <div id="view-detail" class="hidden">
          <div class="back-btn" onclick="backToList()">â€¹ è¿”å›åˆ—è¡¨</div>

          <h3 style="margin:0 0 10px 0;display:flex;justify-content:space-between;align-items:center">
            <span><span id="detail-name">Name</span> <small id="detail-age" style="font-weight:normal;color:#888;font-size:0.6em"></small></span>
            <span id="detail-pose" style="font-size:0.6em;font-weight:normal;padding:3px 6px;background:rgba(0,0,0,0.05);border-radius:4px"></span>
          </h3>

          <div id="detail-stats"></div>

          <div class="section-header">NTR ç›‘æ§</div>
          <div class="card-box" id="detail-ntr"></div>

          <div class="section-header">å†…å¿ƒæ´»åŠ¨</div>
          <div id="detail-mind"></div>

          <div class="section-header">æ€§çˆ±è®°å½•</div>
          <div class="card-box" id="detail-body"></div>
          <div class="card-box" id="detail-last"></div>

          <div class="section-header">æ€§ç»å†</div>
          <div id="detail-sex"></div>
          <div style="height:30px"></div>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
```