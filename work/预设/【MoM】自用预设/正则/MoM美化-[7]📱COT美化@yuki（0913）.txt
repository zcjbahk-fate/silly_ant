```html
<!DOCTYPE html><html lang="zh"><head><meta charset="UTF-8"><title>动态聊天气泡</title><style>:root{--left-bubble-start:rgba(233,233,235,.6);--left-bubble-end:rgba(244,244,245,.6);--right-bubble-start:rgba(0,122,255,.7);--right-bubble-end:rgba(88,86,214,.7);--mobile-bg:url('https://cdn.discordapp.com/attachments/1412090688769757285/1415294257383739473/c79a77120952d57c.png?ex=68c2aefd&is=68c15d7d&hm=f81ef122a0b0b3917a573e205fffb6df2949633a19a441a13471d9281d168efb&')}body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;display:flex;justify-content:center;align-items:center;margin:0;padding:0;box-sizing:border-box}.mobile-screen{width:600px;height:800px;border-radius:42px;overflow:hidden;display:flex;flex-direction:column;position:relative;border:2px solid rgba(0,0,0,.4);box-shadow:0 15px 45px rgba(0,0,0,.25);background-image:var(--mobile-bg);background-size:cover;background-position:center;transition:background-image .3s ease}.status-bar{padding:20px 24px 10px;display:flex;justify-content:space-between;align-items:center;font-size:14px;font-weight:600;color:#333;flex-shrink:0;background-color:rgba(255,255,255,.4);backdrop-filter:blur(10px);border-radius:42px 42px 2px 2px}.status-icons{display:flex;align-items:center;gap:8px}.icon-signal{display:flex;align-items:flex-end;gap:2px}.icon-signal span{background-color:#333;width:3px;border-radius:1px}.icon-signal span:nth-child(1){height:4px}.icon-signal span:nth-child(2){height:7px}.icon-signal span:nth-child(3){height:10px}.icon-signal span:nth-child(4){height:13px;background-color:#e0e0e0}.icon-battery{width:24px;height:11px;border:1.5px solid #333;border-radius:3px;position:relative;background:linear-gradient(to right,#4cd964 80%,transparent 80%)}.icon-battery::after{content:'';position:absolute;right:-4px;top:2px;width:2px;height:6px;background-color:#333;border-radius:0 1px 1px 0}.home-indicator{padding:20px;display:flex;justify-content:center;align-items:center;flex-shrink:0;cursor:pointer;background-color:rgba(255,255,255,.4);backdrop-filter:blur(10px);border-radius:2px 2px 42px 42px}.home-indicator div{width:135px;height:5px;background-color:rgba(0,0,0,.4);border-radius:100px;transition:background-color .2s}.home-indicator:hover div{background-color:rgba(0,0,0,.6)}#chat-container{flex:1;overflow-y:auto;-webkit-overflow-scrolling:touch;background-color:transparent;padding:15px;display:flex;flex-direction:column;gap:15px}#chat-container::-webkit-scrollbar{width:5px}#chat-container::-webkit-scrollbar-thumb{background:rgba(0,0,0,.2);border-radius:10px}#chat-container::-webkit-scrollbar-track{background:transparent}.avatar{width:50px;height:50px;border-radius:50%;object-fit:cover;flex-shrink:0}.message-container{display:flex;width:100%;align-items:flex-start;gap:5px;will-change:transform}.message-container.align-right{justify-content:flex-end}.message-container.align-left{justify-content:flex-start}.chat-bubble{padding:10px 15px;border-radius:18px;max-width:75%;word-wrap:break-word;line-height:1.5;box-shadow:0 1px 2px rgba(0,0,0,.1);border:1px solid rgba(255,255,255,.2);backdrop-filter:blur(5px);white-space:pre-wrap}.bubble-right{background-image:linear-gradient(135deg,var(--right-bubble-start),var(--right-bubble-end));color:#fff}.bubble-left{background-image:linear-gradient(135deg,var(--left-bubble-start),var(--left-bubble-end));color:#000}.chat-bubble img{max-width:100%;max-height:200px;display:block;border-radius:10px}.image-only-bubble{padding:0!important;background:0 0!important;box-shadow:none!important;border:none!important;backdrop-filter:none!important;line-height:0}#settings-panel{position:absolute;bottom:0;left:0;right:0;background-color:rgba(255,255,255,.9);backdrop-filter:blur(10px);border-top:1px solid rgba(0,0,0,.1);padding:20px 25px 30px;transform:translateY(100%);transition:transform .4s cubic-bezier(.25,.8,.25,1);z-index:100;border-radius:20px 20px 42px 42px}#settings-panel.show{transform:translateY(0)}.settings-title{font-size:18px;font-weight:600;margin-bottom:20px;text-align:center;color:#333}.settings-group{margin-bottom:15px}.settings-group label{display:block;font-size:14px;font-weight:500;margin-bottom:8px;color:#555}.settings-group input[type=text],.settings-group input[type=url],.settings-group input[type=file]{width:100%;padding:8px 12px;border:1px solid #ccc;border-radius:8px;box-sizing:border-box;font-size:14px}.settings-group input[type=file]{background-color:#f9f9f9;cursor:pointer}.settings-group input[type=file]::file-selector-button{background-color:#e9e9eb;border:none;padding:8px 12px;border-radius:6px;cursor:pointer;margin-right:10px;font-weight:500}.color-inputs{display:flex;gap:10px}.color-inputs input[type=color]{flex:1;height:40px;border:1px solid #ccc;border-radius:8px;padding:2px;cursor:pointer}.settings-group input[type=range]{width:100%;-webkit-appearance:none;appearance:none;height:5px;background:#ddd;border-radius:5px;outline:0;transition:opacity .2s;cursor:pointer}.settings-group input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:20px;height:20px;background:#fff;border-radius:50%;border:1px solid #ccc;box-shadow:0 1px 3px rgba(0,0,0,.2)}.settings-group input[type=range]::-moz-range-thumb{width:20px;height:20px;background:#fff;border-radius:50%;border:1px solid #ccc;box-shadow:0 1px 3px rgba(0,0,0,.2)}.settings-group label span{float:right;font-weight:400;color:#888}#save-settings-btn{width:100%;padding:12px;border:none;border-radius:12px;background-color:#007aff;color:#fff;font-size:16px;font-weight:600;cursor:pointer;margin-top:10px;transition:background-color .2s}#save-settings-btn:hover{background-color:#0056b3}#reset-settings-btn{width:100%;padding:11px;border:1px solid #c7c7cc;border-radius:12px;background-color:#f2f2f7;color:#007aff;font-size:16px;font-weight:500;cursor:pointer;margin-top:8px;transition:background-color .2s}#reset-settings-btn:hover{background-color:#e5e5ea}</style></head><body><div class="mobile-screen"><div class="status-bar"><div class="time">{{time}}</div><div class="status-icons"><div class="icon-signal"><span></span><span></span><span></span><span></span></div><div class="icon-battery"></div></div></div><div id="chat-container"></div><div id="settings-panel"><div class="settings-title">显示设置</div><div class="settings-group"><label for="bg-upload">手机背景图</label><input type="file" id="bg-upload" accept="image/*"></div><div class="settings-group"><label for="left-avatar-upload">对方头像</label><input type="file" id="left-avatar-upload" accept="image/*"></div><div class="settings-group"><label for="right-avatar-upload">我的头像</label><input type="file" id="right-avatar-upload" accept="image/*"></div><div class="settings-group"><label>对方气泡颜色 (渐变)</label><div class="color-inputs"><input type="color" id="left-color-1" value="#e9e9eb"><input type="color" id="left-color-2" value="#f4f4f5"></div></div><div class="settings-group"><label>我的气泡颜色 (渐变)</label><div class="color-inputs"><input type="color" id="right-color-1" value="#007aff"><input type="color" id="right-color-2" value="#5856d6"></div></div><div class="settings-group"><label for="bubble-opacity">气泡透明度 <span id="opacity-value">80%</span></label><input type="range" id="bubble-opacity" min="0.1" max="1" step="0.05"></div><button id="save-settings-btn">保存并关闭</button><button id="reset-settings-btn">恢复默认设置</button></div><div class="home-indicator" id="settings-toggle"><div></div></div></div><div id="chat-data" style="display:none">$1</div><script>document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("chat-container"),t=document.getElementById("settings-panel"),n=document.getElementById("settings-toggle"),o=document.getElementById("save-settings-btn"),i=document.getElementById("reset-settings-btn"),a=document.getElementById("chat-data"),d=document.documentElement,l=document.getElementById("bg-upload"),c=document.getElementById("left-avatar-upload"),r=document.getElementById("right-avatar-upload"),s=document.getElementById("left-color-1"),m=document.getElementById("left-color-2"),u=document.getElementById("right-color-1"),p=document.getElementById("right-color-2"),g=document.getElementById("bubble-opacity"),h=document.getElementById("opacity-value"),f={bgUrl:"https://cdn.discordapp.com/attachments/1412090688769757285/1415294257383739473/c79a77120952d57c.png?ex=68c2aefd&is=68c15d7d&hm=f81ef122a0b0b3917a573e205fffb6df2949633a19a441a13471d9281d168efb&",leftAvatar:"https://cdn.discordapp.com/attachments/1412090688769757285/1415334842874331146/IMG_9680.jpg?ex=68c2d4ca&is=68c1834a&hm=1f8c247db8e68c6297ebb58efcb952a8d018505886c9901430acd8d7d9a456ae&",rightAvatar:"https://cdn.discordapp.com/attachments/1412090688769757285/1415334843516190812/IMG_9681.jpg?ex=68c2d4ca&is=68c1834a&hm=a3b9a5f95334c157c11e9b957e5a641fe4ed06332b45de45f45a26db9fd351b0&",leftColor1:"#e9e9eb",leftColor2:"#f4f4f5",rightColor1:"#007aff",rightColor2:"#5856d6",bubbleOpacity:.8};let y={...f};const b=(e,t)=>{const n=parseInt(e.slice(1,3),16),o=parseInt(e.slice(3,5),16),i=parseInt(e.slice(5,7),16);return`rgba(${n}, ${o}, ${i}, ${t})`},v=(t,n)=>{if(!t||""===t.trim())return;const o=document.createElement("div");o.className="message-container";const i=document.createElement("div");i.className="chat-bubble",i.innerHTML=t;const a=document.createElement("img");a.className="avatar";const d=document.createElement("div");d.innerHTML=t,1===d.children.length&&"IMG"===d.children[0].tagName&&""===d.textContent.trim()&&i.classList.add("image-only-bubble"),n?(o.classList.add("align-right"),i.classList.add("bubble-right"),a.src=y.rightAvatar,o.appendChild(i),o.appendChild(a)):(o.classList.add("align-left"),i.classList.add("bubble-left"),a.src=y.leftAvatar,o.appendChild(a),o.appendChild(i)),e.appendChild(o)},k=()=>{if(e.innerHTML="",!a)return;const t=a.innerHTML.split(/\r?\n/);let n=[],o=null;const i=()=>{n.length>0&&v(n.join("\n"),"right"===o),n=[]};t.forEach((e=>{const a=e.trim();if(""===a)return i(),void(o=null);const d=a.startsWith("[")&&a.endsWith("]")?"right":"left";d!==o&&null!==o&&i(),o=d,"right"===d?n.push(a.slice(1,-1).trim()):n.push(e)})),i(),e.scrollTop=e.scrollHeight},L=()=>{d.style.setProperty("--mobile-bg",`url('${y.bgUrl}')`),d.style.setProperty("--left-bubble-start",b(y.leftColor1,y.bubbleOpacity)),d.style.setProperty("--left-bubble-end",b(y.leftColor2,y.bubbleOpacity)),d.style.setProperty("--right-bubble-start",b(y.rightColor1,y.bubbleOpacity)),d.style.setProperty("--right-bubble-end",b(y.rightColor2,y.bubbleOpacity)),k(),s.value=y.leftColor1,m.value=y.leftColor2,u.value=y.rightColor1,p.value=y.rightColor2,g.value=y.bubbleOpacity,h.textContent=`${Math.round(100*y.bubbleOpacity)}%`},E=()=>{y.leftColor1=s.value,y.leftColor2=m.value,y.rightColor1=u.value,y.rightColor2=p.value,y.bubbleOpacity=parseFloat(g.value),localStorage.setItem("chatBubbleSettings",JSON.stringify(y))},w=()=>{const e=localStorage.getItem("chatBubbleSettings");e&&(y={...f,...JSON.parse(e)}),L()};n.addEventListener("click",(()=>t.classList.toggle("show"))),o.addEventListener("click",(()=>{E(),L(),t.classList.remove("show")})),i.addEventListener("click",(()=>{confirm("确定要恢复所有默认设置吗？")&&(localStorage.removeItem("chatBubbleSettings"),y={...f},L(),document.getElementById("bg-upload").value="",document.getElementById("left-avatar-upload").value="",document.getElementById("right-avatar-upload").value="",t.classList.remove("show"))}));const x=(e,t)=>{e.addEventListener("change",(e=>{const n=e.target.files[0];if(!n)return;const o=new FileReader;o.onload=e=>{y[t]=e.target.result,L()},o.readAsDataURL(n)}))};x(l,"bgUrl"),x(c,"leftAvatar"),x(r,"rightAvatar");const A=()=>{const e=parseFloat(g.value);d.style.setProperty("--left-bubble-start",b(s.value,e)),d.style.setProperty("--left-bubble-end",b(m.value,e)),d.style.setProperty("--right-bubble-start",b(u.value,e)),d.style.setProperty("--right-bubble-end",b(p.value,e)),h.textContent=`${Math.round(100*e)}%`};[s,m,u,p,g].forEach((e=>{e.addEventListener("input",A)})),w(),k()}));</script></body></html>
```